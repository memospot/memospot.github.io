---
title: Debugging
description: A guide to Memospot debugging.
---

import { Tabs, TabItem } from "@astrojs/starlight/components";

:::note
This is intended for developers and advanced users only.
:::

There's a built-in logger that can help diagnose some issues. It will split logs
into two files:

- `memospot.log`: General application logs.
- `memos.log`: Logs from the embedded Memos server.

Log rotation is enabled by default to prevent log files from growing indefinitely.

:::tip
[yq](https://github.com/mikefarah/yq) is a convenient way to edit configuration files from the command line. It's available at several package managers: Homebrew, MacPorts, Winget, Chocolatey, and Scoop.
:::

## Enabling logging

### [memospot.yaml](/guides/configuration)

```yaml
memospot:
  log:
    enabled: true
```

<Tabs syncKey="os">
    <TabItem label="Windows">
        ```bash
        yq -i '.memospot.log.enabled = true' "$Env:LocalAppData\memospot\memospot.yaml"
        ```
    </TabItem>
    <TabItem label="Linux/macOS">
        ```bash
        yq -i '.memospot.log.enabled = true' "~/.memospot/memospot.yaml"
        ```
    </TabItem>
</Tabs>

## Disabling logging

It's recommended to leave log disabled when not needed.

### [memospot.yaml](/guides/configuration)

```yaml
memospot:
  log:
    enabled: false
```

<Tabs syncKey="os">
    <TabItem label="Windows">
        ```bash
        yq -i '.memospot.log.enabled = false' "$Env:LocalAppData\memospot\memospot.yaml"
        ```
    </TabItem>
    <TabItem label="Linux/macOS">
        ```bash
        yq -i '.memospot.log.enabled = false' "~/.memospot/memospot.yaml"
        ```
    </TabItem>
</Tabs>

## Increasing log level

### [log.yaml](#default-logyaml)

```yaml
root:
  level: debug
```

<Tabs syncKey="os">
    <TabItem label="Windows">
        ```bash
        yq -i '.root.level = "debug"' "$Env:LocalAppData\memospot\log.yaml"
        ```
    </TabItem>
    <TabItem label="Linux/macOS">
        ```bash
        yq -i '.root.level = "debug"' "~/.memospot/log.yaml"
        ```
    </TabItem>
</Tabs>

## Default `log.yaml`

:::tip
If you launch Memospot with an empty or invalid log.yaml, the file
will be automatically populated with a default configuration.
:::

```yaml
# https://docs.rs/log4rs/latest/log4rs/config/index.html#configuration
# https://github.com/estk/log4rs#quick-start
#
# Use absolute paths to prevent trying to write next to the application binary.
# Data directory is available as `$ENV{MEMOSPOT_DATA}`.
appenders:
  memospot:
    encoder:
      pattern: "{d(%Y-%m-%d %H:%M:%S)} {h({l})} {module}: {m}{n}"
    path: $ENV{MEMOSPOT_DATA}/memospot.log
    kind: rolling_file
    policy:
      trigger:
        kind: size
        limit: 1 mb
      roller:
        kind: fixed_window
        pattern: $ENV{MEMOSPOT_DATA}/memospot.log.{}.gz
        count: 5
        base: 1
  memos:
    path: $ENV{MEMOSPOT_DATA}/memos.log
    encoder:
      pattern: "{message}"
    kind: rolling_file
    policy:
      trigger:
        kind: size
        limit: 1 mb
      roller:
        kind: fixed_window
        pattern: $ENV{MEMOSPOT_DATA}/memos.log.{}.gz
        count: 5
        base: 1
root:
  # General app log: debug | info | warn | error | off
  # Can be increased from `info` to `debug` to ease development.
  level: info
  appenders: [memospot]
loggers:
  memospot_lib::memos_log:
    # Memos server log: info | warn | error | off
    level: info
    additive: false # Prevents duplicate log messages.
    appenders: [memos]
  # Suppress messages from dependencies.
  h2: { level: off }
  hyper_util: { level: off }
  reqwest: { level: off }
  tauri_plugin_updater: { level: off }
```

Extra configurations options can be found in the
[log4rs documentation](https://docs.rs/log4rs/latest/log4rs/config/index.html#configuration)

:::note
`$ENV{MEMOSPOT_DATA}` is a special variable available in `log.yaml` that resolves to the same directory where `memospot.yaml` resides.
:::
